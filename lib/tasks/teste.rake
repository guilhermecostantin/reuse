task :teste do 
	


def calcula_peso i, entradas,pesos, target, parada, alfa
    somatorio = 0
    entradas.each_with_index do |x, index|
        somatorio += x*pesos[index]      
    end
    saida = somatorio >= 0 ? 1 : -1
    parada[i] =
        if saida == target
             1
        else
            entradas.each_with_index do |x, index|
                pesos[index] += alfa*x*target
            end     
            0
        end
        #puts "dados da entrada #{i}"
        #puts parada[i]
        #puts pesos
    return parada, pesos

end

def verifica i, entradas, pesos
    
    somatorio = 0
    entradas.each_with_index do |x, index|
        somatorio += x*pesos[index]      
    end
    saida = somatorio >= 0 ? 1 : -1
    tipo =
        if saida == -1
            "Iris-virginica"
        else
            "Iris-setosa"
        end
    puts "Padrao #{i}: Saida = #{saida}, " + tipo
end




parada = 60.times.map { 0 }
pesos = Array.new
pesos = 5.times.map { rand().round(2) }
alfa = 0.0025	
x = [[-1,5.1,3.5,1.4,0.2],
    [-1,4.9,3.0,1.4,0.2],
    [-1,4.7,3.2,1.3,0.2],
    [-1,4.6,3.1,1.5,0.2],
    [-1,5.0,3.6,1.4,0.2],
    [-1,5.4,3.9,1.7,0.4],
    [-1,4.6,3.4,1.4,0.3],
    [-1,5.0,3.4,1.5,0.2],
    [-1,4.4,2.9,1.4,0.2],
    [-1,4.9,3.1,1.5,0.1],
    [-1,5.4,3.7,1.5,0.2],
    [-1,4.8,3.4,1.6,0.2],
    [-1,4.8,3.0,1.4,0.1],
    [-1,4.3,3.0,1.1,0.1],
    [-1,5.8,4.0,1.2,0.2],
    [-1,5.7,4.4,1.5,0.4],
    [-1,5.4,3.9,1.3,0.4],
    [-1,5.1,3.5,1.4,0.3],
    [-1,5.7,3.8,1.7,0.3],
    [-1,5.1,3.8,1.5,0.3],
    [-1,5.4,3.4,1.7,0.2],
    [-1,5.1,3.7,1.5,0.4],
    [-1,4.6,3.6,1.0,0.2],
    [-1,5.1,3.3,1.7,0.5],
    [-1,4.8,3.4,1.9,0.2],
    [-1,5.0,3.0,1.6,0.2],
    [-1,5.0,3.4,1.6,0.4],
    [-1,5.2,3.5,1.5,0.2],
    [-1,5.2,3.4,1.4,0.2],
    [-1,4.7,3.2,1.6,0.2],
    [-1,6.3,3.3,6.0,2.5],
    [-1,5.8,2.7,5.1,1.9],
    [-1,7.1,3.0,5.9,2.1],
    [-1,6.3,2.9,5.6,1.8],
    [-1,6.5,3.0,5.8,2.2],
    [-1,7.6,3.0,6.6,2.1],
    [-1,4.9,2.5,4.5,1.7],
    [-1,7.3,2.9,6.3,1.8],
    [-1,6.7,2.5,5.8,1.8],
    [-1,7.2,3.6,6.1,2.5],
    [-1,6.5,3.2,5.1,2.0],
    [-1,6.4,2.7,5.3,1.9],
    [-1,6.8,3.0,5.5,2.1],
    [-1,5.7,2.5,5.0,2.0],
    [-1,5.8,2.8,5.1,2.4],
    [-1,6.4,3.2,5.3,2.3],
    [-1,6.5,3.0,5.5,1.8],
    [-1,7.7,3.8,6.7,2.2],
    [-1,7.7,2.6,6.9,2.3],
    [-1,6.0,2.2,5.0,1.5],
    [-1,6.9,3.2,5.7,2.3],
    [-1,5.6,2.8,4.9,2.0],
    [-1,7.7,2.8,6.7,2.0],
    [-1,6.3,2.7,4.9,1.8],
    [-1,6.7,3.3,5.7,2.1],
    [-1,7.2,3.2,6.0,1.8],
    [-1,6.2,2.8,4.8,1.8],
    [-1,6.1,3.0,4.9,1.8],
    [-1,6.4,2.8,5.6,2.1],
    [-1,7.2,3.0,5.8,1.6]];

target=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];
y =	[[-1,4.5,2.3,1.3,0.3],
    [-1,6.3,2.5,5.0,1.9],
    [-1,5.8,2.7,5.1,1.9],
    [-1,6.7,3.0,5.2,2.3],
    [-1,6.5,3.0,5.2,2.0],
    [-1,5.9,3.0,5.1,1.8],
    [-1,4.8,3.0,1.4,0.3],
    [-1,6.7,3.1,5.6,2.4],
    [-1,6.9,3.1,5.1,2.3],
    [-1,6.8,3.2,5.9,2.3],
    [-1,4.4,3.2,1.3,0.2],
    [-1,4.6,3.2,1.4,0.2],
    [-1,6.7,3.3,5.7,2.5],
    [-1,5.0,3.3,1.4,0.2],
    [-1,6.2,3.4,5.4,2.3],
    [-1,5.0,3.5,1.3,0.3],
    [-1,5.0,3.5,1.6,0.6],
    [-1,5.3,3.7,1.5,0.2],
    [-1,5.1,3.8,1.9,0.4],
    [-1,5.1,3.8,1.6,0.2]];
epoca = 0
#puts "pesos iniciais:"
puts pesos
puts parada
while parada.include?(0)
    60.times do |i|
    	parada, pesos = calcula_peso i, x[i], pesos, target[i], parada, alfa
    end
    epoca+=1
end
puts pesos
20.times do |i|
    verifica i, y[i], pesos
end
puts "Foram necessarias #{epoca} epocas para treinar"

#puts "acabou"
#puts parada
	
end